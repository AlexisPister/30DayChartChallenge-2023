import{S as st,i as ct,s as lt,k as W,q as Y,a as X,l as O,m as _,r as Z,h as T,c as G,n as D,b as ft,H as A,C as U,o as ut}from"../chunks/index.06a14631.js";import{_ as ht,M as dt,j as mt,g as pt,a as gt,b as yt,d as vt,e as wt,f as Q,ab as Mt,ac as Et,a9 as bt,ad as kt,a6 as xt,p as St}from"../chunks/plot.81b3b730.js";import{t as Ct,d as It}from"../chunks/dot.e600da08.js";import{A as zt}from"../chunks/transform.2ac1f063.js";import{s as At}from"../chunks/select.c6d05060.js";import{e as Dt}from"../chunks/extent.4cf1c809.js";import{k as Nt,j as it}from"../chunks/continuous.a94dc564.js";import{m as tt}from"../chunks/max.adfc8a60.js";import{l as et}from"../chunks/linearRegression.12ca190d.js";const Lt=Pt(Ft);function Pt(t){return function(n,s,c=s){if(!((s=+s)>=0))throw new RangeError("invalid rx");if(!((c=+c)>=0))throw new RangeError("invalid ry");let{data:e,width:i,height:o}=n;if(!((i=Math.floor(i))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(o!==void 0?o:e.length/i))>=0))throw new RangeError("invalid height");if(!i||!o||!s&&!c)return n;const h=s&&t(s),u=c&&t(c),r=e.slice();return h&&u?(B(h,r,e,i,o),B(h,e,r,i,o),B(h,r,e,i,o),$(u,e,r,i,o),$(u,r,e,i,o),$(u,e,r,i,o)):h?(B(h,e,r,i,o),B(h,r,e,i,o),B(h,e,r,i,o)):u&&($(u,e,r,i,o),$(u,r,e,i,o),$(u,e,r,i,o)),n}}function B(t,n,s,c,e){for(let i=0,o=c*e;i<o;)t(n,s,i,i+=c,1)}function $(t,n,s,c,e){for(let i=0,o=c*e;i<c;++i)t(n,s,i,i+o,c)}function Ft(t){const n=Math.floor(t);if(n===t)return Wt(t);const s=t-n,c=2*t+1;return(e,i,o,h,u)=>{if(!((h-=u)>=o))return;let r=n*i[o];const l=u*n,d=l+u;for(let f=o,m=o+l;f<m;f+=u)r+=i[Math.min(h,f)];for(let f=o,m=h;f<=m;f+=u)r+=i[Math.min(h,f+l)],e[f]=(r+s*(i[Math.max(o,f-d)]+i[Math.min(h,f+d)]))/c,r-=i[Math.max(o,f-l)]}}function Wt(t){const n=2*t+1;return(s,c,e,i,o)=>{if(!((i-=o)>=e))return;let h=t*c[e];const u=o*t;for(let r=e,l=e+u;r<l;r+=o)h+=c[Math.min(i,r)];for(let r=e,l=i;r<=l;r+=o)h+=c[Math.min(i,r+u)],s[r]=h/n,h-=c[Math.max(e,r-u)]}}function Ot(t,n,s){let c;for(;;){const e=Nt(t,n,s);if(e===c||e===0||!isFinite(e))return[t,n];e>0?(t=Math.floor(t/e)*e,n=Math.ceil(n/e)*e):e<0&&(t=Math.ceil(t*e)/e,n=Math.floor(n*e)/e),c=e}}function Tt(t){return At(zt(t).call(document.documentElement))}var Rt=Array.prototype,at=Rt.slice;function _t(t,n){return t-n}function jt(t){for(var n=0,s=t.length,c=t[s-1][1]*t[0][0]-t[s-1][0]*t[0][1];++n<s;)c+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return c}const R=t=>()=>t;function Ht(t,n){for(var s=-1,c=n.length,e;++s<c;)if(e=Vt(t,n[s]))return e;return 0}function Vt(t,n){for(var s=n[0],c=n[1],e=-1,i=0,o=t.length,h=o-1;i<o;h=i++){var u=t[i],r=u[0],l=u[1],d=t[h],f=d[0],m=d[1];if(Bt(u,d,n))return 0;l>c!=m>c&&s<(f-r)*(c-l)/(m-l)+r&&(e=-e)}return e}function Bt(t,n,s){var c;return $t(t,n,s)&&Yt(t[c=+(t[0]===n[0])],s[c],n[c])}function $t(t,n,s){return(n[0]-t[0])*(s[1]-t[1])===(s[0]-t[0])*(n[1]-t[1])}function Yt(t,n,s){return t<=n&&n<=s||s<=n&&n<=t}function Zt(){}var L=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function nt(){var t=1,n=1,s=Ct,c=u;function e(r){var l=s(r);if(Array.isArray(l))l=l.slice().sort(_t);else{const d=Dt(r,qt);for(l=it(...Ot(d[0],d[1],l),l);l[l.length-1]>=d[1];)l.pop();for(;l[1]<d[0];)l.shift()}return l.map(d=>i(r,d))}function i(r,l){const d=l==null?NaN:+l;if(isNaN(d))throw new Error(`invalid value: ${l}`);var f=[],m=[];return o(r,d,function(p){c(p,r,d),jt(p)>0?f.push([p]):m.push(p)}),m.forEach(function(p){for(var w=0,x=f.length,y;w<x;++w)if(Ht((y=f[w])[0],p)!==-1){y.push(p);return}}),{type:"MultiPolygon",value:l,coordinates:f}}function o(r,l,d){var f=new Array,m=new Array,p,w,x,y,a,M;for(p=w=-1,y=j(r[0],l),L[y<<1].forEach(v);++p<t-1;)x=y,y=j(r[p+1],l),L[x|y<<1].forEach(v);for(L[y<<0].forEach(v);++w<n-1;){for(p=-1,y=j(r[w*t+t],l),a=j(r[w*t],l),L[y<<1|a<<2].forEach(v);++p<t-1;)x=y,y=j(r[w*t+t+p+1],l),M=a,a=j(r[w*t+p+1],l),L[x|y<<1|a<<2|M<<3].forEach(v);L[y|a<<3].forEach(v)}for(p=-1,a=r[w*t]>=l,L[a<<2].forEach(v);++p<t-1;)M=a,a=j(r[w*t+p+1],l),L[a<<2|M<<3].forEach(v);L[a<<3].forEach(v);function v(k){var E=[k[0][0]+p,k[0][1]+w],b=[k[1][0]+p,k[1][1]+w],I=h(E),z=h(b),g,S;(g=m[I])?(S=f[z])?(delete m[g.end],delete f[S.start],g===S?(g.ring.push(b),d(g.ring)):f[g.start]=m[S.end]={start:g.start,end:S.end,ring:g.ring.concat(S.ring)}):(delete m[g.end],g.ring.push(b),m[g.end=z]=g):(g=f[z])?(S=m[I])?(delete f[g.start],delete m[S.end],g===S?(g.ring.push(b),d(g.ring)):f[S.start]=m[g.end]={start:S.start,end:g.end,ring:S.ring.concat(g.ring)}):(delete f[g.start],g.ring.unshift(E),f[g.start=I]=g):f[I]=m[z]={start:I,end:z,ring:[E,b]}}}function h(r){return r[0]*2+r[1]*(t+1)*4}function u(r,l,d){r.forEach(function(f){var m=f[0],p=f[1],w=m|0,x=p|0,y=J(l[x*t+w]);m>0&&m<t&&w===m&&(f[0]=rt(m,J(l[x*t+w-1]),y,d)),p>0&&p<n&&x===p&&(f[1]=rt(p,J(l[(x-1)*t+w]),y,d))})}return e.contour=i,e.size=function(r){if(!arguments.length)return[t,n];var l=Math.floor(r[0]),d=Math.floor(r[1]);if(!(l>=0&&d>=0))throw new Error("invalid size");return t=l,n=d,e},e.thresholds=function(r){return arguments.length?(s=typeof r=="function"?r:Array.isArray(r)?R(at.call(r)):R(r),e):s},e.smooth=function(r){return arguments.length?(c=r?u:Zt,e):c===u},e}function qt(t){return isFinite(t)?t:NaN}function j(t,n){return t==null?!1:+t>=n}function J(t){return t==null||isNaN(t=+t)?-1/0:t}function rt(t,n,s,c){const e=c-n,i=s-n,o=isFinite(e)||isFinite(i)?e/i:Math.sign(e)/Math.sign(i);return isNaN(o)?t:t+o-.5}function Xt(t){return t[0]}function Gt(t){return t[1]}function Ut(){return 1}function Jt(){var t=Xt,n=Gt,s=Ut,c=960,e=500,i=20,o=2,h=i*3,u=c+h*2>>o,r=e+h*2>>o,l=R(20);function d(a){var M=new Float32Array(u*r),v=Math.pow(2,-o),k=-1;for(const H of a){var E=(t(H,++k,a)+h)*v,b=(n(H,k,a)+h)*v,I=+s(H,k,a);if(I&&E>=0&&E<u&&b>=0&&b<r){var z=Math.floor(E),g=Math.floor(b),S=E-z-.5,P=b-g-.5;M[z+g*u]+=(1-S)*(1-P)*I,M[z+1+g*u]+=S*(1-P)*I,M[z+1+(g+1)*u]+=S*P*I,M[z+(g+1)*u]+=(1-S)*P*I}}return Lt({data:M,width:u,height:r},i*v),M}function f(a){var M=d(a),v=l(M),k=Math.pow(2,2*o);return Array.isArray(v)||(v=it(Number.MIN_VALUE,tt(M)/k,v)),nt().size([u,r]).thresholds(v.map(E=>E*k))(M).map((E,b)=>(E.value=+v[b],m(E)))}f.contours=function(a){var M=d(a),v=nt().size([u,r]),k=Math.pow(2,2*o),E=b=>{b=+b;var I=m(v.contour(M,b*k));return I.value=b,I};return Object.defineProperty(E,"max",{get:()=>tt(M)/k}),E};function m(a){return a.coordinates.forEach(p),a}function p(a){a.forEach(w)}function w(a){a.forEach(x)}function x(a){a[0]=a[0]*Math.pow(2,o)-h,a[1]=a[1]*Math.pow(2,o)-h}function y(){return h=i*3,u=c+h*2>>o,r=e+h*2>>o,f}return f.x=function(a){return arguments.length?(t=typeof a=="function"?a:R(+a),f):t},f.y=function(a){return arguments.length?(n=typeof a=="function"?a:R(+a),f):n},f.weight=function(a){return arguments.length?(s=typeof a=="function"?a:R(+a),f):s},f.size=function(a){if(!arguments.length)return[c,e];var M=+a[0],v=+a[1];if(!(M>=0&&v>=0))throw new Error("invalid size");return c=M,e=v,y()},f.cellSize=function(a){if(!arguments.length)return 1<<o;if(!((a=+a)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(a)/Math.LN2),y()},f.thresholds=function(a){return arguments.length?(l=typeof a=="function"?a:Array.isArray(a)?R(at.call(a)):R(a),f):l},f.bandwidth=function(a){if(!arguments.length)return Math.sqrt(i*(i+1));if(!((a=+a)>=0))throw new Error("invalid bandwidth");return i=(Math.sqrt(4*a*a+1)-1)/2,y()},f}const Kt={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Qt extends dt{constructor(n,{x:s,y:c,z:e,weight:i,fill:o,stroke:h,...u}={}){const r=ot(o)&&(o="currentColor",!0),l=ot(h)&&(h="currentColor",!0);super(n,{x:{value:s,scale:"x",optional:!0},y:{value:c,scale:"y",optional:!0},z:{value:mt({z:e,fill:o,stroke:h}),optional:!0},weight:{value:i,optional:!0}},ne({...u,fill:o,stroke:h},r,l),Kt),r&&(this.fill=void 0),l&&(this.stroke=void 0),this.z=e}filter(n){return n}render(n,s,c,e,i){const{contours:o}=c,h=pt();return Tt("svg:g").call(gt,this,e,i).call(yt,this,{}).call(u=>u.selectAll().data(n).enter().append("path").call(vt,this).call(wt,this,c).attr("d",r=>h(o[r]))).node()}}function te(t,n={}){let{x:s,y:c,...e}=n;return[s,c]=ht(s,c),new Qt(t,{...e,x:s,y:c})}const ee=new Set(["x","y","z","weight"]);function ne(t,n,s){let{bandwidth:e,thresholds:i}=t;return e=e===void 0?20:+e,i=i===void 0?20:typeof(i==null?void 0:i[Symbol.iterator])=="function"?Q(i):+i,Mt(t,function(o,h,u,r,l,d){var H;const f=u.weight?Q(u.weight.value):null,m=(H=u.z)==null?void 0:H.value,{z:p}=this,[w,x]=xt(this,l),{width:y,height:a}=l,{x:M,y:v}=Et(u,r,d),k=Object.fromEntries(Object.entries(u).filter(([C])=>!ee.has(C)).map(([C,N])=>[C,{...N,value:[]}])),E=n&&[],b=s&&[],I=Jt().x(M?C=>M[C]:w).y(v?C=>v[C]:x).weight(f?C=>f[C]:1).size([y,a]).bandwidth(e),z=[];for(const C of h){const N=[];z.push(N);for(const F of m?bt(C,m,p):[C]){const V=I.contours(F);N.push([F,V])}}let g=i;if(!(g instanceof kt)){let C=0;for(const N of z)for(const[,F]of N){const V=F.max;V>C&&(C=V)}g=Float64Array.from({length:i-1},(N,F)=>C*100*(F+1)/i)}const S=[],P=[];for(const C of z){const N=[];S.push(N);for(const[F,V]of C)for(const q of g){N.push(P.length),P.push(V(q/100)),E&&E.push(q),b&&b.push(q);for(const K in k)k[K].value.push(u[K].value[F[0]])}}return E&&E.push(0),b&&b.push(0),{data:o,facets:S,channels:{...k,...E&&{fill:{value:E,scale:"color"}},...b&&{stroke:{value:b,scale:"color"}},contours:{value:P}}}})}function ot(t){return/^density$/i.test(t)}function re(t){let n,s,c,e,i,o,h,u,r,l,d,f,m,p,w;return{c(){n=W("div"),s=W("div"),c=W("h1"),e=Y("Simpson's Paradox with Iris dataset"),i=X(),o=W("h3"),h=Y("The Sepal width of Iris flowers is positively correlated with sepal length but inversely correlated when looking at Iris species individually."),u=X(),r=W("div"),l=Y(`Data Source: Iris dataset
            Layout: `),d=W("a"),f=Y("Observable Plot"),m=W("br"),p=X(),w=W("div"),this.h()},l(x){n=O(x,"DIV",{id:!0,class:!0});var y=_(n);s=O(y,"DIV",{id:!0,class:!0});var a=_(s);c=O(a,"H1",{class:!0});var M=_(c);e=Z(M,"Simpson's Paradox with Iris dataset"),M.forEach(T),i=G(a),o=O(a,"H3",{id:!0,class:!0});var v=_(o);h=Z(v,"The Sepal width of Iris flowers is positively correlated with sepal length but inversely correlated when looking at Iris species individually."),v.forEach(T),u=G(a),r=O(a,"DIV",{id:!0,class:!0});var k=_(r);l=Z(k,`Data Source: Iris dataset
            Layout: `),d=O(k,"A",{href:!0});var E=_(d);f=Z(E,"Observable Plot"),E.forEach(T),m=O(k,"BR",{}),k.forEach(T),a.forEach(T),p=G(y),w=O(y,"DIV",{id:!0});var b=_(w);b.forEach(T),y.forEach(T),this.h()},h(){D(c,"class","svelte-1mk3ic7"),D(o,"id","subtitle"),D(o,"class","svelte-1mk3ic7"),D(d,"href","https://altair-viz.github.io/index.html"),D(r,"id","data-source"),D(r,"class","svelte-1mk3ic7"),D(s,"id","main-text"),D(s,"class","svelte-1mk3ic7"),D(w,"id","graph"),D(n,"id","container"),D(n,"class","svelte-1mk3ic7")},m(x,y){ft(x,n,y),A(n,s),A(s,c),A(c,e),A(s,i),A(s,o),A(o,h),A(s,u),A(s,r),A(r,l),A(r,d),A(d,f),A(r,m),A(n,p),A(n,w)},p:U,i:U,o:U,d(x){x&&T(n)}}}const oe=1300,ie=1e3;function ae(t,n,s){let{data:c}=n,e=c.data;console.log(Object.keys(e[0])),console.log(e),e=e.filter(o=>o.Species),ut(()=>{i()});function i(){let o=St({style:{fontSize:"11px"},color:{type:"categorical",scheme:"dark2",legend:!0},marks:[It(e,{x:"SepalLengthCm",y:"SepalWidthCm",fill:"Species",r:3}),te(e,{x:"SepalLengthCm",y:"SepalWidthCm",bandwidth:20,fillOpacity:.1,stroke:"Species",strokeWidth:.8,strokeOpacity:.8}),et(e,{x:"SepalLengthCm",y:"SepalWidthCm",stroke:"Species",strokeWidth:2.5,ci:null}),et(e,{x:"SepalLengthCm",y:"SepalWidthCm",strokeWidth:2.5,ci:null})],y:{type:"linear"},x:{type:"linear"},marginBottom:40,marginLeft:60,width:oe-200,height:ie-200});document.querySelector("#graph").append(o)}return t.$$set=o=>{"data"in o&&s(0,c=o.data)},[c]}class ge extends st{constructor(n){super(),ct(this,n,ae,re,lt,{data:0})}}export{ge as default};
