import{S as Q,i as Y,s as Z,k as I,q as V,a as X,J as ee,l as w,m as H,r as F,h as _,c as q,K as te,n as o,b as ae,H as l,C as N,o as ne}from"../chunks/index.2e204e96.js";import{s as z}from"../chunks/transform.3e593064.js";import{s as ie,m as M,a as P}from"../chunks/Set2.4b6542ef.js";import{d as re}from"../chunks/descending.129c84e0.js";import{o as se}from"../chunks/ordinal.9aa01bae.js";function de(K){let h,y,A,L,m,c,D,f,j,S,g,i,n,r,t,s;return{c(){h=I("div"),y=I("div"),A=I("h1"),L=V("Dune novel's main characters family tree"),m=X(),c=I("div"),D=V("Data Source: "),f=I("a"),j=V("dune.fandom.com"),S=V(`
            Layout: `),g=I("a"),i=V("D3JS"),n=I("br"),r=X(),t=I("div"),s=ee("svg"),this.h()},l(v){h=w(v,"DIV",{id:!0,class:!0});var x=H(h);y=w(x,"DIV",{id:!0,class:!0});var E=H(y);A=w(E,"H1",{class:!0});var $=H(A);L=F($,"Dune novel's main characters family tree"),$.forEach(_),m=q(E),c=w(E,"DIV",{id:!0,class:!0});var p=H(c);D=F(p,"Data Source: "),f=w(p,"A",{href:!0,class:!0});var R=H(f);j=F(R,"dune.fandom.com"),R.forEach(_),S=F(p,`
            Layout: `),g=w(p,"A",{href:!0,class:!0});var b=H(g);i=F(b,"D3JS"),b.forEach(_),n=w(p,"BR",{}),p.forEach(_),E.forEach(_),r=q(x),t=w(x,"DIV",{id:!0});var U=H(t);s=te(U,"svg",{width:!0,height:!0,class:!0});var k=H(s);k.forEach(_),U.forEach(_),x.forEach(_),this.h()},h(){o(A,"class","svelte-1ltsyvs"),o(f,"href","https://dune.fandom.com/"),o(f,"class","svelte-1ltsyvs"),o(g,"href","https://d3js.org/"),o(g,"class","svelte-1ltsyvs"),o(c,"id","data-source"),o(c,"class","svelte-1ltsyvs"),o(y,"id","main-text"),o(y,"class","svelte-1ltsyvs"),o(s,"width",K[0]),o(s,"height",oe),o(s,"class","svelte-1ltsyvs"),o(t,"id","graph"),o(h,"id","container"),o(h,"class","svelte-1ltsyvs")},m(v,x){ae(v,h,x),l(h,y),l(y,A),l(A,L),l(y,m),l(y,c),l(c,D),l(c,f),l(f,j),l(c,S),l(c,g),l(g,i),l(c,n),l(h,r),l(h,t),l(t,s)},p(v,[x]){x&1&&o(s,"width",v[0])},i:N,o:N,d(v){v&&_(h)}}}const oe=1e3;function le(K,h,y){let A=[[{id:"Paulus Atréides",affiliation:"Atréides"},{id:"Héléna Richese",affiliation:"Richese"},{id:"Vladimir Harkonnen",affiliation:"Harkonnen"},{id:"Tanidia Nerus"},{id:"Elrood IX",affiliation:"Corrino"},{id:"Unknown2"},{id:"Abulurd Harkonnen II",affiliation:"Harkonnen"},{id:"Emmi Rabban"},{id:"Unknown"}],[{id:"Leto Atréides",parents:["Paulus Atréides","Héléna Richese"],affiliation:"Atréides"},{id:"Jessica Atréides",parents:["Vladimir Harkonnen","Tanidia Nerus"],affiliation:"Atréides"},{id:"Liet Kynes",affiliation:"Fremen"},{id:"Faroula",affiliation:"Fremen"},{id:"Anirul Corrino",affiliation:"Corrino"},{id:"Shaddam IV Corrino",parents:["Elrood IX","Unknown2"],affiliation:"Corrino"},{id:"Glossu Rabban",parents:["Abulurd Harkonnen II","Emmi Rabban"],affiliation:"Harkonnen"},{id:"Feyd-Rautha Harkonnen",parents:["Abulurd Harkonnen II","Unknown"],affiliation:"Harkonnen"}],[{id:"Alia Atréides",parents:["Leto Atréides","Jessica Atréides"],affiliation:"Atréides"},{id:"Paul Atréides",parents:["Leto Atréides","Jessica Atréides"],affiliation:"Atréides"},{id:"Chani Kynes",parents:["Liet Kynes","Faroula"],affiliation:"Fremen"},{id:"Irulan Corrino",parents:["Shaddam IV Corrino","Anirul Corrino"],affiliation:"Corrino"},{id:"Wensicia Corrino",parents:["Shaddam IV Corrino","Anirul Corrino"],affiliation:"Corrino"},{id:"Unknown1"}],[{id:"Leto Atréides II",parents:["Paul Atréides","Chani Kynes"],affiliation:"Atréides"},{id:"Paul Atréides II the elder",parents:["Paul Atréides","Chani Kynes"],affiliation:"Atréides"},{id:"Ghanima Atreides",parents:["Paul Atréides","Chani Kynes"],affiliation:"Atréides"},{id:"Farad'n Corrino",parents:["Wensicia Corrino","Unknown1"],affiliation:"Corrino"}]],L={Harkonnen:0,Atréides:1,Fremen:2,Corrino:3,Richese:4,undefined:5},m,c=1300,D=Object.keys(L).slice(0,-1).concat([void 0]);const f=se(ie).domain(Object.keys(L).slice(0,-1).concat([void 0])).range(["#4377b9","#e51b1a","#f4d4a9","#f0f001","#3797af","lightgray"]);ne(()=>{m=j(A),y(0,c=m.layout.width),console.log(m),S()});function j(i,n={}){i.forEach((e,a)=>e.forEach(d=>d.level=a));var r=i.reduce((e,a)=>e.concat(a),[]),t={};r.forEach(e=>t[e.id]=e),r.forEach(e=>{e.parents=(e.parents===void 0?[]:e.parents).map(a=>t[a])}),i.forEach((e,a)=>{var d={};e.forEach(u=>{if(u.parents.length!=0){var C=u.parents.map(T=>T.id).sort().join("-X-");C in d?d[C].parents=d[C].parents.concat(u.parents):d[C]={id:C,parents:u.parents.slice(),level:a,span:a-M(u.parents,T=>T.level)},u.bundle=d[C]}}),e.bundles=Object.keys(d).map(u=>d[u]),e.bundles.forEach((u,C)=>u.i=C)});var s=[];r.forEach(e=>{e.parents.forEach(a=>s.push({source:e,bundle:e.bundle,target:a}))});var v=i.reduce((e,a)=>e.concat(a.bundles),[]);v.forEach(e=>e.parents.forEach(a=>{a.bundles_index===void 0&&(a.bundles_index={}),e.id in a.bundles_index||(a.bundles_index[e.id]=[]),a.bundles_index[e.id].push(e)})),r.forEach(e=>{e.bundles_index!==void 0?e.bundles=Object.keys(e.bundles_index).map(a=>e.bundles_index[a]):(e.bundles_index={},e.bundles=[]),e.bundles.sort((a,d)=>re(P(a,u=>u.span),P(d,u=>u.span))),e.bundles.forEach((a,d)=>a.i=d)}),s.forEach(e=>{e.bundle.links===void 0&&(e.bundle.links=[]),e.bundle.links.push(e)});const x=8,E=30,$=180,p=14,R=16,b=4,U=22;n.c||(n.c=16);const k=n.c;n.bigc||(n.bigc=$+k),r.forEach(e=>e.height=(Math.max(1,e.bundles.length)-1)*b);var O=x,J=x;i.forEach(e=>{O+=e.bundles.length*p,J+=R,e.forEach((a,d)=>{a.x=a.level*$+O,a.y=E+J+a.height/2,J+=E+a.height})});var G=0;i.forEach(e=>{e.bundles.forEach(a=>{a.x=P(a.parents,d=>d.x)+$+(e.bundles.length-1-a.i)*p,a.y=G*E}),G+=e.length}),s.forEach(e=>{e.xt=e.target.x,e.yt=e.target.y+e.target.bundles_index[e.bundle.id].i*b-e.target.bundles.length*b/2+b/2,e.xb=e.bundle.x,e.yb=e.bundle.y,e.xs=e.source.x,e.ys=e.source.y});var W=0;i.forEach(e=>{W+=-U+M(e.bundles,a=>M(a.links,d=>d.ys-2*k-(d.yt+k)))||0,e.forEach(a=>a.y-=W)}),s.forEach(e=>{e.yt=e.target.y+e.target.bundles_index[e.bundle.id].i*b-e.target.bundles.length*b/2+b/2,e.ys=e.source.y,e.c1=e.source.level-e.target.level>1?Math.min(n.bigc,e.xb-e.xt,e.yb-e.yt)-k:k,e.c2=k});var B={width:P(r,e=>e.x)+$+2*x,height:P(r,e=>e.y)+E/2+2*x,node_height:E,node_width:$,bundle_width:p,level_y_padding:R,metro_d:b};return{levels:i,nodes:r,nodes_index:t,links:s,bundles:v,layout:B}}function S(){const i=z("svg");i.selectAll(".label").data(m.nodes).join("text").classed("label",!0).text(n=>n.id.includes("known")?"Unknown":n.id).attr("x",n=>n.x+7).attr("y",n=>n.y-4).attr("fill",n=>f(n.affiliation)),i.selectAll(".path").data(m.links).join(n=>{let r=n.append("g");return r.append("path").attr("d",t=>(t.source.affiliation,t.target.affiliation,`
                      M${t.xt} ${t.yt}
                      L${t.xb-t.c1} ${t.yt}
                      A${t.c1} ${t.c1} 90 0 1 ${t.xb} ${t.yt+t.c1}
                      L${t.xb} ${t.ys-t.c2}
                      A${t.c2} ${t.c2} 90 0 0 ${t.xb+t.c2} ${t.ys}
                      L${t.xs} ${t.ys}`)).attr("fill","none").attr("stroke",t=>f(t.source.affiliation)),r.append("path").attr("d",t=>`
                      M${t.xt} ${t.yt}
                      L${t.xb-t.c1} ${t.yt}
                      A${t.c1} ${t.c1} 90 0 1 ${t.xb} ${t.yt+t.c1}
                      L${t.xb} ${t.ys-t.c2}
                      A${t.c2} ${t.c2} 90 0 0 ${t.xb+t.c2} ${t.ys}
                      L${t.xs} ${t.ys}`).attr("fill","none").attr("stroke",t=>f(t.source.affiliation)).attr("stroke-dasharray",t=>4),r}).classed(".path",!0),i.selectAll(".node").data(m.nodes).join("circle").classed("node",!0).attr("cx",n=>n.x).attr("cy",n=>n.y).attr("r",n=>4).attr("fill",n=>f(n.affiliation)).attr("stroke",n=>"black"),g()}function g(){let i=z("svg").append("g").attr("transform","translate(500, 70)"),n=100,r=33;i.append("text").text("Affiliations").attr("transform",(t,s)=>`translate(${n-4},10)`).attr("fill","white").attr("font-size","22px"),i.selectAll(".dot").data(D).join("rect").attr("transform",(t,s)=>`translate(${n}, ${r+s*25})`).attr("x",-7).attr("y",-7).attr("width",10).attr("height",10).style("fill",function(t){return f(t)}).classed("dot",!0),i.selectAll(".llabel").data(D).join("text").attr("x",n+20).attr("y",function(t,s){return r+s*25}).style("fill",function(t){return f(t)}).text(function(t){return t||"Other/Unknown"}).style("alignment-baseline","middle").classed("llabel",!0)}return[c]}class ye extends Q{constructor(h){super(),Y(this,h,le,de,Z,{})}}export{ye as default};
